.. _approach :

System Approach
===============


The Urban TEP is based on a generic, modular, multi-purpose design facilitating
maximum flexibility with respect to the adaptation to and integration of user requirements,
application scenarios, processing and analysis technologies, and IT infrastructures.
Considering the thematic and technical objectives of Urban TEP, the essential
requirements on the Urban TEP architecture are:

- Web-based platform to access, explore, generate, analyze, validate and visualize geospatial data (in particular EO imagery) and derived products.
- Processing infrastructure for very fast, cost effective and operational 
  1) access to multiple satellite mission archives (in particular ESA and Sentinel archives), 
  2) implementation and operation of VA processors.
- Thematic value-adding processors providing geo-information products on the urban environment and its development.
- Expert knowledge and user community integration by means of active target community participation. 


Web-based platform
------------------

The central element in the Urban TEP concept is the Web-based platform. It builds
from extensive knowledge acquired by Terradue on the development and maintenance of the
Agency’s Grid Processing on Demand (G-POD) system, the development of the early TEP platforms (Tep-QuickWin then Geohazard TEP) 
and the integration of scientific applications and services for the EC projects GEOWOW and SenSyF.


Data-driven platform
--------------------

Data is the fuel of the Urban TEP platform and thus needs to be managed with systems
in order to harvest, discover and query many collections of datsets from various Earth Observation missions.
The :ref:`design_dataagency` components are an evolution of the experiences and operational deployments
made in the context of the European Commission FP7 GENESI-DEC project and then applied on
the G-POD catalogues. Terradue developed a full system for the data management with state-of-the-art
technology for super fast indexing of dataset metadata document and implementing the community
specifications such as OpenSearch or OWS Context.


Processing infrastructure approach
----------------------------------

Another key component and functionality of the Urban TEP platform is the
processing infrastructure provided by the processing centers. The processing
centres generate the datasets offered by the Urban TEP and provide means for
user-driven bulk processing with often highly parameterisable thematic
processors, and aggregation of results to composites or other value-added
products. The availability of input satellite datasets on the platform and the
thematic context makes the approach attractive for urban applications.

Processing centres provide cluster infrastructures that support bulk processing
of large datasets. Bulk processing can simply be requested by users by
specifying the temporal and spatial extent of the input dataset. For processing
results of common interest that shall be provided by the Urban TEP as a dataset
a processing centre can systematically generate it (by an internal request).

Among the users of the Urban TEP there will be those that mainly use provided
data products generated by the processing centres, visualise them and combine
them in analysis, and those that also initiate processing with available
processors and that are interested in the results. Well known-users and
projects may also come with their own processors and may publish them as
service on the TEP or the results as available dataset. Also this will be
supported by processing centres.

TEP Urban will include a total of three distributed data and processing centers
with individual infrastructural sub-systems: the virtualised environment of
DLR’s Geofarm, but also including a Calvalus/Hadoop sub-system, another
Calvalus/Hadoop environment provided by Brockmann Consult, and one HPC-based
processing facility operated by IT4Innovation. Each of the processing centres 
maintain shared resources that are dynamically allocated to the requests of the 
users by cluster schedulers. Details are described with the respective processing centres 
in chapter :ref:`bcpc_components_list`, :ref:`it4ipc_components_list`, and 
:ref:`dlrpc_components_list`.


Processor development approach
------------------------------

The Urban TEP integrates and provides several thematic data processors that can
be parameterised and used with the datasets available on the platform in many
flexible ways. In addition to this the TEP is an environment open for
well-known users and projects to develop and deploy their own processors for
the generation of datasets or the provision of processing services.

The approach for processor development is characterised by

- the provision of a development environment to users that develop processors
  for Urban data processing
- sample input data from various sensors for testing
- commonly used processing frameworks and language environments available in
  the development environment and in the processing centres
- tools to support the packaging and deployment of processors to the processing
  centres
- a schema for processor parameterisation and a calling convention
- rather simple and working than complicated and feature-rich

The development environment is a prepared virtual machine image that either can
be used in a virtualised infrastructure in one of the processing centres
(IT4I), or it can be downloaded by users for local development and deployment
of locally tested processors into the processing centres for larger scale
validation. The approach for packaging of processors with individual
dependencies are Docker containers. Basic containers with commonly used tools
pre-installed will be provided. Individual processor runtimes and
all other required dependencies can be added.


Data visualization
------------------

World Bank Group has developed with the expertise of GISAT its Platform for Urban Mapping and Analysis (PUMA),
which is complementary and can benefit from the Tep Urban infrastructure, products and services development.
It is a key element for the data analysis and visualization of the Urban thematic data.


Authentication and Authorization concept
----------------------------------------

User authentication on the Urban TEP platform ensure identity of users, concurrent use of the platform, and proper reporting. User authentication is based on ESA single-sign-on EO-SSO. 

The Urban TEP portal is the interface to the user and the gateway to the other Urban TEP backend services, e.g. the processing centres. The portal implements authentication and ensures against the backend service the identity of the user. Example: A user accesses the portal to submit a processing request, e.g. by filling a form, and the portal forwards the request to the processing centre's machine-to-machine (WPS) interface in behalf of the user. The same holds for processing result access. The request is forwarded by the portal to the processing centre. Also this is authenticated by the portal. 

For backend services that are separate subsystems like the processing centres the portal authenticates itself internally against the backend service in order to ensure that requests stem from the portal. The portal always provides the external user information in the requests, but no new external user authentication is required as this is already asserted by the portal.

The U-TEP authorization concept is based on the logical relationships between a user and all the :ref:`objects` with which it can be associated. First and basic relationship is being the **owner** of the entities (e.g. User A owns data collection Y). The ownership of an entity can be transferred from the owner to any other user. Then, a user may *share* a business objet with another user, a group of user or via a share link. In both cases, user specifies the possible **permissions** on that object (e.g. service can be viewable, editable, executable). This mechanism is ensured by an general authorization scheme that combines

- users and groups;
- the user communities, also called domain (e.g. Terradue, World Bank, ESA...);
- the role of users or groups of users in this community (e.g. end users, data provider, service provider...);
- the user objects (e.g. data colllections, services, thematic applications...);
- their associated permissions (can view, can edit, can execute, can search...).

A complete system
-----------------

Based on functional software components described in the previous sections, mainly based on existing/established software packages, configured specifically for their use in Urban TEP, the consortium will provide an integrated system. This system will group the components into subsystems for the portal, visualisation, and decentralised processing centres with different EO datasets interfaces between components for the workflows implementing the Urban TEP use cases, flexible enough to allow for new use cases. The integration with existing external systems, e.g. for visualisation (PUMA) and processing clusters are also taken into account in the design of the system.

